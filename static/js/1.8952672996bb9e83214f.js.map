{"version":3,"sources":["webpack:///src/components/master/post-add.vue","webpack:///./src/components/master/post-add.vue?a405","webpack:///./src/components/master/post-add.vue"],"names":["post_add","data","categories","post","category","title","body","updatedAt","tags","newTagInputVisible","newTagInputValue","beforeRouteEnter","to","from","next","vm","getPost","beforeRouteLeave","this","resetNewPost","methods","handleClose","tag","splice","indexOf","showInput","_this","$nextTick","_","$refs","saveNewTagInput","input","focus","handleInputConfirm","newTag","push","self","id","$route","params","axios_default","a","get","util","api","then","resp","doSavePost","kits","moment","utc","format","put","$router","name","err","console","log","computed","postPreviewHtml","preview","master_post_add","render","_vm","_h","$createElement","_c","_self","staticClass","attrs","size","model","value","callback","$$v","$set","expression","_l","c","key","label","_v","type","plain","on","click","closable","close","$event","_s","ref","staticStyle","width","blur","nativeOn","keyup","_k","keyCode","autosize","minRows","maxRows","domProps","innerHTML","staticRenderFns","Component","__webpack_require__","normalizeComponent","ssrContext","__webpack_exports__"],"mappings":"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","file":"static/js/1.8952672996bb9e83214f.js","sourcesContent":["<template>\n  <div class=\"post-editor\">\n    <div class=\"post-edit\">\n      <div class=\"post-edit-category-and-title\">\n        <el-select class=\"post-category\" v-model=\"post.category\" size=\"mini\">\n          <el-option v-for=\"c in categories\" v-bind:key=\"c\" :label=\"c\" :value=\"c\"></el-option>\n        </el-select>\n        <el-input class=\"post-title\" v-model=\"post.title\" size=\"mini\"/>\n        <el-button type=\"primary\" plain size=\"mini\" @click=\"doSavePost\">save</el-button>\n      </div>\n      <div class=\"post-tags-row\">\n        <el-tag :key=\"tag\" v-for=\"tag in post.tags\" type=\"danger\" size=\"small\"\n                closable @close=\"handleClose(tag)\">{{tag}}\n        </el-tag>\n        <el-input style=\"width:90px;\"\n          v-if=\"newTagInputVisible\"\n          v-model=\"newTagInputValue\"\n          ref=\"saveNewTagInput\"\n          size=\"mini\"\n          @keyup.enter.native=\"handleInputConfirm\"\n          @blur=\"handleInputConfirm\"\n        />\n        <el-button v-else type=\"default\" size=\"mini\" @click=\"showInput\" plain>+ New Tag</el-button>\n      </div>\n      <el-input type=\"textarea\" :autosize=\"{minRows: 32, maxRows: 32}\" class=\"post-body\" v-model=\"post.body\"/>\n    </div>\n    <div class=\"post-preview\" v-html=\"postPreviewHtml\"></div>\n  </div>\n</template>\n\n<script>\nimport util from '@/assets/util.js'\nimport axios from 'axios'\n\nexport default {\n  data () {\n    return {\n      categories: ['tech', 'idea', 'other'],\n      post: {\n        category: 'other',\n        title: '',\n        body: '',\n        updatedAt: '',\n        tags: []\n      },\n      newTagInputVisible: false,\n      newTagInputValue: ''\n    }\n  },\n  beforeRouteEnter (to, from, next) {\n    next(vm => {\n      vm.getPost()\n    })\n  },\n  beforeRouteLeave (to, from, next) {\n    this.resetNewPost()\n    next()\n  },\n  methods: {\n    handleClose (tag) {\n      this.post.tags.splice(this.post.tags.indexOf(tag), 1)\n    },\n    showInput () {\n      this.newTagInputVisible = true\n      this.$nextTick(_ => {\n        this.$refs.saveNewTagInput.$refs.input.focus()\n      })\n    },\n    handleInputConfirm () {\n      let newTag = this.newTagInputValue\n      if (newTag) {\n        this.post.tags.push(newTag)\n      }\n      this.newTagInputVisible = false\n      this.newTagInputValue = ''\n    },\n    resetNewPost () { // 先进编辑页面、再到新增，此时已编辑的旧文应该被清空\n      this.post = {category: 'other', title: '', body: '', updatedAt: '', tags: []}\n    },\n    getPost () {\n      let self = this\n      let id = self.$route.params.id\n      if (id) {\n        axios.get(util.api.post + id).then(resp => {\n          // console.log(resp)\n          self.post = resp.data\n        })\n      }\n    },\n    doSavePost () { // 保存或更新\n      this.post.updatedAt = util.kits.moment.utc().format('YYYY-MM-DD HH:mm:ss') // 按UTC时间存\n      let id = this.$route.params.id\n      let self = this\n      if (id) {\n        axios.put(util.api.post + id, self.post).then(resp => {\n          // console.log(resp)\n          self.$router.push({name: 'post-all'})\n        }, err => {\n          console.log(err)\n        })\n      } else {\n        axios.post(util.api.post, self.post).then(resp => {\n          // console.log(resp)\n          self.$router.push({name: 'post-all'})\n        }, err => {\n          console.log(err)\n        })\n      }\n    }\n  },\n  computed: {\n    postPreviewHtml () {\n      return util.kits.preview(this.post.body)\n    }\n  }\n}\n\n</script>\n\n<style scoped>\n.post-editor, .post-edit-category-and-title{\n  display: flex;\n}\n.post-edit, .post-preview{\n  width:50%;\n  height:768px;\n}\n.post-title{\n  margin: auto 5px;\n}\n.post-tags-row{\n  text-align: left;\n  margin: 6px auto;\n}\n.el-tag{\n  margin-right: 6px;\n}\n.post-preview{\n  text-align: left;\n  border-left: 1px solid #f2f2f2;\n  padding-left: 20px;\n  padding-right: 20px;\n}\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/components/master/post-add.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"post-editor\"},[_c('div',{staticClass:\"post-edit\"},[_c('div',{staticClass:\"post-edit-category-and-title\"},[_c('el-select',{staticClass:\"post-category\",attrs:{\"size\":\"mini\"},model:{value:(_vm.post.category),callback:function ($$v) {_vm.$set(_vm.post, \"category\", $$v)},expression:\"post.category\"}},_vm._l((_vm.categories),function(c){return _c('el-option',{key:c,attrs:{\"label\":c,\"value\":c}})})),_vm._v(\" \"),_c('el-input',{staticClass:\"post-title\",attrs:{\"size\":\"mini\"},model:{value:(_vm.post.title),callback:function ($$v) {_vm.$set(_vm.post, \"title\", $$v)},expression:\"post.title\"}}),_vm._v(\" \"),_c('el-button',{attrs:{\"type\":\"primary\",\"plain\":\"\",\"size\":\"mini\"},on:{\"click\":_vm.doSavePost}},[_vm._v(\"save\")])],1),_vm._v(\" \"),_c('div',{staticClass:\"post-tags-row\"},[_vm._l((_vm.post.tags),function(tag){return _c('el-tag',{key:tag,attrs:{\"type\":\"danger\",\"size\":\"small\",\"closable\":\"\"},on:{\"close\":function($event){_vm.handleClose(tag)}}},[_vm._v(_vm._s(tag)+\"\\n      \")])}),_vm._v(\" \"),(_vm.newTagInputVisible)?_c('el-input',{ref:\"saveNewTagInput\",staticStyle:{\"width\":\"90px\"},attrs:{\"size\":\"mini\"},on:{\"blur\":_vm.handleInputConfirm},nativeOn:{\"keyup\":function($event){if(!('button' in $event)&&_vm._k($event.keyCode,\"enter\",13,$event.key,\"Enter\")){ return null; }return _vm.handleInputConfirm($event)}},model:{value:(_vm.newTagInputValue),callback:function ($$v) {_vm.newTagInputValue=$$v},expression:\"newTagInputValue\"}}):_c('el-button',{attrs:{\"type\":\"default\",\"size\":\"mini\",\"plain\":\"\"},on:{\"click\":_vm.showInput}},[_vm._v(\"+ New Tag\")])],2),_vm._v(\" \"),_c('el-input',{staticClass:\"post-body\",attrs:{\"type\":\"textarea\",\"autosize\":{minRows: 32, maxRows: 32}},model:{value:(_vm.post.body),callback:function ($$v) {_vm.$set(_vm.post, \"body\", $$v)},expression:\"post.body\"}})],1),_vm._v(\" \"),_c('div',{staticClass:\"post-preview\",domProps:{\"innerHTML\":_vm._s(_vm.postPreviewHtml)}})])}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-304562e0\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/components/master/post-add.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-304562e0\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./post-add.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./post-add.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./post-add.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-304562e0\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/vue-loader/lib/selector?type=template&index=0!./post-add.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-304562e0\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/master/post-add.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}